<!DOCTYPE html>
<html lang="pt-br">

<head>
    <meta charset="UTF-8">
    <title>Gest√£o de Estoque</title>
    <link rel="stylesheet" href="/style.css">
</head>

<body>
    <header>
        <h2>üìä Gest√£o de Estoque</h2>
        <nav>
            <a href="/dashboard">üè† Dashboard</a> |
            <a href="/cadastro-produto">üì¶ Produtos</a> |
            <a href="/logout">üö™ Sair</a>
        </nav>
    </header>

    <main>
        <section>
            <h3>‚ûï Registrar movimenta√ß√£o</h3>
            <form action="/gestao-estoque" method="POST" class="form-mov">
                <select name="product_id" required>
                    <option value="">-- Selecione o produto --</option>
                    <% produtos.forEach(p=> { %>
                        <option value="<%= p.id %>">
                            <%= p.name %> (Estoque: <%= p.qty %>)
                        </option>
                        <% }) %>
                </select>

                <select name="type" required>
                    <option value="entrada">Entrada</option>
                    <option value="saida">Sa√≠da</option>
                </select>

                <input type="number" name="quantity" min="1" placeholder="Quantidade" required>
                <input type="date" name="movement_date" value="<%= new Date().toISOString().slice(0,10) %>" required>
                <input type="text" name="note" placeholder="Observa√ß√£o (opcional)">
                <button type="submit">Registrar</button>
            </form>
        </section>

        <section>
            <h3>üïì √öltimas movimenta√ß√µes</h3>
            <table>
                <thead>
                    <tr>
                        <th>Produto</th>
                        <th>Usu√°rio</th>
                        <th>Tipo</th>
                        <th>Qtd</th>
                        <th>Data</th>
                        <th>Saldo</th>
                        <th>Observa√ß√£o</th>
                    </tr>
                </thead>
                <tbody>
                    <% movimentos.forEach(m=> { %>
                        <tr class="<%= m.type === 'saida' ? 'saida' : 'entrada' %>">
                            <td>
                                <%= m.produto %>
                            </td>
                            <td>
                                <%= m.usuario %>
                            </td>
                            <td>
                                <%= m.type %>
                            </td>
                            <td>
                                <%= m.quantity %>
                            </td>
                            <td>
                                <%= m.data %>
                            </td>
                            <td>
                                <%= m.balance_after %>
                            </td>
                            <td>
                                <%= m.note || '-' %>
                            </td>
                        </tr>
                        <% }) %>
                </tbody>
            </table>
        </section>
    </main>
</body>

</html>